(function(c,e){typeof exports=="object"&&typeof module!="undefined"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(c=typeof globalThis!="undefined"?globalThis:c||self,e(c["vue-universal-modal"]={},c.Vue))})(this,function(c,e){"use strict";const S=({modalRef:t,latest:o,show:d})=>{let s;function i(a){const r=a.target.closest(`.${p}`);if(!!o.value&&(!r||r!==t.value)){if(r&&!r.classList.contains(`${p}-show`))return;s=a.target}}function u(a){a?t.value&&t.value.focus():s&&s.focus()}e.onMounted(()=>{document.addEventListener("click",i),e.watch(()=>d.value,a=>{e.nextTick(()=>u(a))},{immediate:d.value})}),e.onUnmounted(()=>{document.removeEventListener("click",i)})},D=({close:t,closeClickDimmed:o,closeKeyCode:d,latest:s})=>{let i=null;function u(n){i=n.target}function a(n){o&&i===n.target&&t.value(),i=null}function r(n){n.keyCode===d&&s.value&&t.value()}return e.onMounted(()=>{d&&document.addEventListener("keyup",r)}),e.onUnmounted(()=>{d&&document.removeEventListener("keyup",r)}),{onMouseDownDimmed:u,onMouseUpDimmed:a}},x=({modalRef:t,show:o})=>{const{visibleModals:d,addVisibleModals:s,removeVisibleModals:i}=e.inject(f),u=e.computed(()=>{const a=[...d.value.values()];return!a.length||!t.value?!1:a[a.length-1]===t.value});return e.watch(()=>o.value,()=>{e.nextTick(()=>{!t.value||(o.value?s(t.value):i(t.value))})},{immediate:!0}),{latest:u}};var $=(()=>`.vue-universal-modal-leave-from[data-v-d5c05a12],.vue-universal-modal-enter-to[data-v-d5c05a12]{opacity:1}.vue-universal-modal-enter-from[data-v-d5c05a12],.vue-universal-modal-leave-to[data-v-d5c05a12]{opacity:0}.vue-universal-modal[data-v-d5c05a12]{-webkit-overflow-scrolling:touch;overscroll-behavior:contain;position:fixed;overflow-y:auto;left:0;top:0;right:0;bottom:0;background-color:#000c;text-align:left}.vue-universal-modal[data-v-d5c05a12]:not(.vue-universal-modal-latest){z-index:1000}.vue-universal-modal-content[data-v-d5c05a12]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;min-height:100%}.modal[data-v-d5c05a12]{position:fixed;width:100%;bottom:0;box-sizing:border-box;font-size:20px;text-align:center;background:var(--ion-item-background, var(--ion-background-color, #fff));border-radius:10px 10px 0 0/10px 10px 0px 0px;overflow:hidden}.start-modal[data-v-d5c05a12],.vue-universal-modal-enter-to .modal[data-v-d5c05a12],.vue-universal-modal-leave-from .modal[data-v-d5c05a12]{transition-timing-function:cubic-bezier(.11,.93,.28,1);transition-property:transform;transition-duration:.3s;transform:translateZ(0)}.vue-universal-modal-enter-from .modal[data-v-d5c05a12],.vue-universal-modal-leave-to .modal[data-v-d5c05a12]{transition-timing-function:cubic-bezier(.74,0,.23,1);transition-property:transform;transition-duration:.3s;transform:translate3d(0,100%,0)!important}
`)(),E=(t,o)=>{const d=t.__vccOpts||t;for(const[s,i]of o)d[s]=i;return d};const L=e.defineComponent({inheritAttrs:!1,props:{fullscreen:{type:Boolean,default:!1},swipe:{type:Boolean,default:!0},close:{type:Function,default:()=>{}},disabled:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!0},options:{type:Object,default:()=>({})}},emits:["before-enter","enter","after-enter","enter-cancelled","before-leave","leave","after-leave","leave-cancelled"],setup(t,o){const{teleportTarget:d}=e.inject(f),{close:s,disabled:i,options:u,modelValue:a}=e.toRefs(t),r=e.ref(a.value===void 0?!0:a.value),n=e.ref(null),h=e.ref(!i.value),v={transition:300,closeClickDimmed:!0,closeKeyCode:27,styleModalContent:{},...u.value};e.watch([()=>a.value,()=>i.value],()=>{const l=a.value&&!i.value;h.value=l,a.value&&(r.value=a.value)},{immediate:!0});const{latest:g}=x({modalRef:n,show:h});S({latest:g,modalRef:n,show:h});const{onMouseDownDimmed:N,onMouseUpDimmed:V}=D({close:s,closeClickDimmed:v.closeClickDimmed,closeKeyCode:v.closeKeyCode,latest:g}),U=l=>{V(l),s.value&&s.value()};let y=0;const M=l=>{l.preventDefault(),l.stopPropagation(),l.stopImmediatePropagation(),y=l.touches[0].clientY,l.currentTarget.style.transitionDuration="0ms"};let C=0;const b=l=>{const m=Math.round(l.touches[0].clientY-y);m!=C&&m>0&&(l.currentTarget.style.transform=`translate3d(0, ${m}px, 0)`),C=m},w=l=>{l.preventDefault(),l.stopPropagation(),l.stopImmediatePropagation(),l.changedTouches[0].clientY-y!=0?(l.currentTarget.style.transitionDuration="200ms",e.nextTick(()=>{l.currentTarget.style.transform="translate3d(0, 0%, 0)"})):l.currentTarget.style.transitionDuration="300ms"};return{Log:l=>{},CLASS_NAME:p,emitClose:()=>{s.value&&s.value()},inserted:r,latest:g,mergeOptions:v,modalRef:n,onMouseDownDimmed:N,onMouseUpDimmed2:U,touchModalStart:M,touchModalMove:b,touchModalEnd:w,onTransitionEmit:{beforeEnter:()=>o.emit("before-enter",n.value),enter:()=>o.emit("enter",n.value),afterEnter:()=>{n.value.querySelector(".modal").addEventListener("touchstart",M,{passive:!1}),n.value.querySelector(".modal").addEventListener("touchmove",b,{passive:!0}),n.value.querySelector(".modal").addEventListener("touchend",w,{passive:!1}),o.emit("after-enter",{targetRef:n,close:t.close})},enterCancelled:()=>o.emit("enter-cancelled",n.value),beforeLeave:()=>o.emit("before-leave",n.value),leave:()=>{n.value.querySelector(".modal").removeEventListener("touchstart",M,{passive:!1}),n.value.querySelector(".modal").removeEventListener("touchmove",b,{passive:!0}),n.value.querySelector(".modal").removeEventListener("touchend",w,{passive:!1}),o.emit("leave",n.value)},afterLeave:()=>{o.emit("after-leave",n.value),a.value===!1&&(r.value=!1)},leaveCancelled:()=>o.emit("leave-cancelled",n.value)},show:h,teleportTarget:d,transition:v.transition?v.transition/1e3+"s":void 0}}}),T={class:"modal modal-sheet"};function k(t,o,d,s,i,u){return t.inserted?(e.openBlock(),e.createBlock(e.Teleport,{key:0,to:t.teleportTarget,disabled:t.disabled},[e.createVNode(e.Transition,e.mergeProps({appear:"",name:t.CLASS_NAME},e.toHandlers(t.onTransitionEmit)),{default:e.withCtx(()=>{var a;return[e.withDirectives(e.createElementVNode("div",e.mergeProps({ref:"modalRef",role:"dialog",tabindex:"-1","aria-modal":"true","aria-label":"Modal window",class:[t.CLASS_NAME,{[`${t.CLASS_NAME}-show`]:t.show},{[`${t.CLASS_NAME}-latest`]:t.latest}],style:{transitionDuration:t.transition}},t.$attrs),[e.createElementVNode("div",{class:e.normalizeClass(`${t.CLASS_NAME}-content`),style:e.normalizeStyle({transitionDuration:t.transition,...(a=t.mergeOptions)==null?void 0:a.styleModalContent}),onMousedown:o[0]||(o[0]=e.withModifiers((...r)=>t.onMouseDownDimmed&&t.onMouseDownDimmed(...r),["self"])),onMouseup:o[1]||(o[1]=e.withModifiers((...r)=>t.onMouseUpDimmed2&&t.onMouseUpDimmed2(...r),["self"])),onTouchmove:o[2]||(o[2]=e.withModifiers(r=>t.close(),["self"]))},[e.createElementVNode("div",T,[e.renderSlot(t.$slots,"default",{emitClose:t.emitClose},void 0,!0),e.renderSlot(t.$slots,"close",{},void 0,!0)])],38)],16),[[e.vShow,t.show]])]}),_:3},16,["name"])],8,["to","disabled"])):e.createCommentVNode("",!0)}var A=E(L,[["render",k],["__scopeId","data-v-d5c05a12"]]);const f="VueUniversalModal",p="vue-universal-modal";var _={install:(t,o={})=>{const{teleportTarget:d="",modalComponent:s="Modal"}=o;if(!d)return;const i=e.ref(new Set),u=r=>{i.value.add(r)},a=r=>{i.value.delete(r)};t.provide(f,{teleportTarget:d,visibleModals:e.readonly(i),addVisibleModals:u,removeVisibleModals:a}),t.component(s,A)}};c.CLASS_NAME=p,c.PLUGIN_NAME=f,c.default=_,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
