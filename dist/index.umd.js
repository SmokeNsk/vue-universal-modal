(function(c,t){typeof exports=="object"&&typeof module!="undefined"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(c=typeof globalThis!="undefined"?globalThis:c||self,t(c["vue-universal-modal"]={},c.Vue))})(this,function(c,t){"use strict";const S=({modalRef:e,latest:o,show:i})=>{let r;function s(a){const n=a.target.closest(`.${p}`);if(!!o.value&&(!n||n!==e.value)){if(n&&!n.classList.contains(`${p}-show`))return;r=a.target}}function d(a){a?e.value&&e.value.focus():r&&r.focus()}t.onMounted(()=>{document.addEventListener("click",s),t.watch(()=>i.value,a=>{t.nextTick(()=>d(a))},{immediate:i.value})}),t.onUnmounted(()=>{document.removeEventListener("click",s)})},D=({close:e,closeClickDimmed:o,closeKeyCode:i,latest:r})=>{let s=null;function d(l){s=l.target}function a(l){o&&s===l.target&&e.value(),s=null}function n(l){l.keyCode===i&&r.value&&e.value()}return t.onMounted(()=>{i&&document.addEventListener("keyup",n)}),t.onUnmounted(()=>{i&&document.removeEventListener("keyup",n)}),{onMouseDownDimmed:d,onMouseUpDimmed:a}},E=({modalRef:e,show:o})=>{const{visibleModals:i,addVisibleModals:r,removeVisibleModals:s}=t.inject(f),d=t.computed(()=>{const a=[...i.value.values()];return!a.length||!e.value?!1:a[a.length-1]===e.value});return t.watch(()=>o.value,()=>{t.nextTick(()=>{!e.value||(o.value?r(e.value):s(e.value))})},{immediate:!0}),{latest:d}};var U=(()=>`.vue-universal-modal-leave-from[data-v-5bc836f3],.vue-universal-modal-enter-to[data-v-5bc836f3]{opacity:1}.vue-universal-modal-enter-from[data-v-5bc836f3],.vue-universal-modal-leave-to[data-v-5bc836f3]{opacity:0}.vue-universal-modal[data-v-5bc836f3]{-webkit-overflow-scrolling:touch;overscroll-behavior:contain;position:fixed;overflow-y:auto;left:0;top:0;right:0;bottom:0;background-color:#000c;text-align:left}.vue-universal-modal[data-v-5bc836f3]:not(.vue-universal-modal-latest){z-index:1000}.vue-universal-modal-content[data-v-5bc836f3]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;min-height:100%}
`)(),L=(e,o)=>{const i=e.__vccOpts||e;for(const[r,s]of o)i[r]=s;return i};const T=t.defineComponent({inheritAttrs:!1,props:{fullscreen:{type:Boolean,default:!1},swipe:{type:Boolean,default:!0},close:{type:Function,default:()=>{}},disabled:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!0},options:{type:Object,default:()=>({})}},emits:["before-enter","enter","after-enter","enter-cancelled","before-leave","leave","after-leave","leave-cancelled"],setup(e,o){const{teleportTarget:i}=t.inject(f),{close:r,disabled:s,options:d,modelValue:a}=t.toRefs(e),n=t.ref(a.value===void 0?!0:a.value),l=t.ref(null),h=t.ref(!s.value),v={transition:300,closeClickDimmed:!0,closeKeyCode:27,styleModalContent:{},...d.value};t.watch([()=>a.value,()=>s.value],()=>{const u=a.value&&!s.value;h.value=u,a.value&&(n.value=a.value)},{immediate:!0});const{latest:M}=E({modalRef:l,show:h});S({latest:M,modalRef:l,show:h});const{onMouseDownDimmed:x,onMouseUpDimmed:N}=D({close:r,closeClickDimmed:v.closeClickDimmed,closeKeyCode:v.closeKeyCode,latest:M}),V=u=>{N(u),r.value&&r.value()};let y=0;const b=u=>{y=u.touches[0].clientY,u.currentTarget.style.transitionDuration="0ms"};let C=0;const g=u=>{const m=Math.round(u.touches[0].clientY-y);m!=C&&m>0&&(u.currentTarget.style.transform=`translate3d(0, ${m}px, 0)`),C=m},w=u=>{u.changedTouches[0].clientY-y!=0?(u.currentTarget.style.transitionDuration="200ms",t.nextTick(()=>{u.currentTarget.style.transform="translate3d(0, 0%, 0)"})):u.currentTarget.style.transitionDuration="300ms"};return{Log:u=>{},CLASS_NAME:p,emitClose:()=>{r.value&&r.value()},inserted:n,latest:M,mergeOptions:v,modalRef:l,onMouseDownDimmed:x,onMouseUpDimmed2:V,touchModalStart:b,touchModalMove:g,touchModalEnd:w,onTransitionEmit:{beforeEnter:()=>o.emit("before-enter",l.value),enter:()=>o.emit("enter",l.value),afterEnter:()=>{l.value.querySelector(".modal").addEventListener("touchstart",b,{passive:!0}),l.value.querySelector(".modal").addEventListener("touchmove",g,{passive:!0}),l.value.querySelector(".modal").addEventListener("touchend",w,{passive:!0}),o.emit("after-enter",{targetRef:l,close:e.close})},enterCancelled:()=>o.emit("enter-cancelled",l.value),beforeLeave:()=>o.emit("before-leave",l.value),leave:()=>{l.value.querySelector(".modal").removeEventListener("touchstart",b,{passive:!0}),l.value.querySelector(".modal").removeEventListener("touchmove",g,{passive:!1}),l.value.querySelector(".modal").removeEventListener("touchend",w,{passive:!0}),o.emit("leave",l.value)},afterLeave:()=>{o.emit("after-leave",l.value),a.value===!1&&(n.value=!1)},leaveCancelled:()=>o.emit("leave-cancelled",l.value)},show:h,teleportTarget:i,transition:v.transition?v.transition/1e3+"s":void 0}}});function k(e,o,i,r,s,d){return e.inserted?(t.openBlock(),t.createBlock(t.Teleport,{key:0,to:e.teleportTarget,disabled:e.disabled},[t.createVNode(t.Transition,t.mergeProps({appear:"",name:e.CLASS_NAME},t.toHandlers(e.onTransitionEmit)),{default:t.withCtx(()=>{var a;return[t.withDirectives(t.createElementVNode("div",t.mergeProps({ref:"modalRef",role:"dialog",tabindex:"-1","aria-modal":"true","aria-label":"Modal window",class:[e.CLASS_NAME,{[`${e.CLASS_NAME}-show`]:e.show},{[`${e.CLASS_NAME}-latest`]:e.latest}],style:{transitionDuration:e.transition}},e.$attrs),[t.createElementVNode("div",{class:t.normalizeClass(`${e.CLASS_NAME}-content`),style:t.normalizeStyle({transitionDuration:e.transition,...(a=e.mergeOptions)==null?void 0:a.styleModalContent}),onMousedown:o[0]||(o[0]=t.withModifiers((...n)=>e.onMouseDownDimmed&&e.onMouseDownDimmed(...n),["self"])),onMouseup:o[1]||(o[1]=t.withModifiers((...n)=>e.onMouseUpDimmed2&&e.onMouseUpDimmed2(...n),["self"])),onTouchmove:o[2]||(o[2]=t.withModifiers(n=>e.close(),["self"]))},[t.renderSlot(e.$slots,"default",{emitClose:e.emitClose},void 0,!0),t.renderSlot(e.$slots,"close",{},void 0,!0)],38)],16),[[t.vShow,e.show]])]}),_:3},16,["name"])],8,["to","disabled"])):t.createCommentVNode("",!0)}var A=L(T,[["render",k],["__scopeId","data-v-5bc836f3"]]);const f="VueUniversalModal",p="vue-universal-modal";var _={install:(e,o={})=>{const{teleportTarget:i="",modalComponent:r="Modal"}=o;if(!i)return;const s=t.ref(new Set),d=n=>{s.value.add(n)},a=n=>{s.value.delete(n)};e.provide(f,{teleportTarget:i,visibleModals:t.readonly(s),addVisibleModals:d,removeVisibleModals:a}),e.component(r,A)}};c.CLASS_NAME=p,c.PLUGIN_NAME=f,c.default=_,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
