(function(c,e){typeof exports=="object"&&typeof module!="undefined"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(c=typeof globalThis!="undefined"?globalThis:c||self,e(c["vue-universal-modal"]={},c.Vue))})(this,function(c,e){"use strict";const S=({modalRef:t,latest:o,show:r})=>{let i;function s(l){const n=l.target.closest(`.${p}`);if(!!o.value&&(!n||n!==t.value)){if(n&&!n.classList.contains(`${p}-show`))return;i=l.target}}function d(l){l?t.value&&t.value.focus():i&&i.focus()}e.onMounted(()=>{document.addEventListener("click",s),e.watch(()=>r.value,l=>{e.nextTick(()=>d(l))},{immediate:r.value})}),e.onUnmounted(()=>{document.removeEventListener("click",s)})},D=({close:t,closeClickDimmed:o,closeKeyCode:r,latest:i})=>{let s=null;function d(a){s=a.target}function l(a){o&&s===a.target&&t.value(),s=null}function n(a){a.keyCode===r&&i.value&&t.value()}return e.onMounted(()=>{r&&document.addEventListener("keyup",n)}),e.onUnmounted(()=>{r&&document.removeEventListener("keyup",n)}),{onMouseDownDimmed:d,onMouseUpDimmed:l}},E=({modalRef:t,show:o})=>{const{visibleModals:r,addVisibleModals:i,removeVisibleModals:s}=e.inject(f),d=e.computed(()=>{const l=[...r.value.values()];return!l.length||!t.value?!1:l[l.length-1]===t.value});return e.watch(()=>o.value,()=>{e.nextTick(()=>{!t.value||(o.value?i(t.value):s(t.value))})},{immediate:!0}),{latest:d}};var B=(()=>`.vue-universal-modal-leave-from[data-v-65b97ef8],.vue-universal-modal-enter-to[data-v-65b97ef8]{opacity:1}.vue-universal-modal-enter-from[data-v-65b97ef8],.vue-universal-modal-leave-to[data-v-65b97ef8]{opacity:0}.vue-universal-modal[data-v-65b97ef8]{-webkit-overflow-scrolling:touch;overscroll-behavior:contain;position:fixed;overflow-y:auto;left:0;top:0;right:0;bottom:0;background-color:#000c;text-align:left}.vue-universal-modal[data-v-65b97ef8]:not(.vue-universal-modal-latest){z-index:1000}.vue-universal-modal-content[data-v-65b97ef8]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;min-height:100%}
`)(),N=(t,o)=>{const r=t.__vccOpts||t;for(const[i,s]of o)r[i]=s;return r};const k=e.defineComponent({inheritAttrs:!1,props:{fullscreen:{type:Boolean,default:!1},swipe:{type:Boolean,default:!0},close:{type:Function,default:()=>{}},disabled:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!0},options:{type:Object,default:()=>({})}},emits:["before-enter","enter","after-enter","enter-cancelled","before-leave","leave","after-leave","leave-cancelled"],setup(t,o){const{teleportTarget:r}=e.inject(f),{close:i,disabled:s,options:d,modelValue:l}=e.toRefs(t),n=e.ref(l.value===void 0?!0:l.value),a=e.ref(null),y=e.ref(!s.value),v={transition:300,closeClickDimmed:!0,closeKeyCode:27,styleModalContent:{},...d.value};e.watch([()=>l.value,()=>s.value],()=>{const u=l.value&&!s.value;y.value=u,l.value&&(n.value=l.value)},{immediate:!0});const{latest:h}=E({modalRef:a,show:y});S({latest:h,modalRef:a,show:y});const{onMouseDownDimmed:_,onMouseUpDimmed:x}=D({close:i,closeClickDimmed:v.closeClickDimmed,closeKeyCode:v.closeKeyCode,latest:h}),V=u=>{x(u),i.value&&i.value()};let M=0;const b=u=>{M=u.touches[0].clientY,a.value.getElementsByClassName("modal")[0].style.transitionDuration="0ms"};let g=0;const C=u=>{const m=Math.round(u.touches[0].clientY-M);m!=g&&m>0&&(a.value.getElementsByClassName("modal")[0].style.transform=`translate3d(0, ${m}px, 0)`),g=m},w=u=>{alert(JSON.stringify(u)),u.changedTouches[0].clientY-M!=0?(a.value.getElementsByClassName("modal")[0].style.transitionDuration="200ms",e.nextTick(()=>{a.value.getElementsByClassName("modal")[0].style.transform="translate3d(0, 0%, 0)"})):a.value.getElementsByClassName("modal")[0].style.transitionDuration="300ms"};return{Log:u=>{},CLASS_NAME:p,emitClose:()=>{i.value&&i.value()},inserted:n,latest:h,mergeOptions:v,modalRef:a,onMouseDownDimmed:_,onMouseUpDimmed2:V,touchModalStart:b,touchModalMove:C,touchModalEnd:w,onTransitionEmit:{beforeEnter:()=>o.emit("before-enter",a.value),enter:()=>o.emit("enter",a.value),afterEnter:()=>{a.value.querySelector(".modal").ontouchstart=b,a.value.querySelector(".modal").ontouchmove=C,a.value.querySelector(".modal").ontouchend=w,o.emit("after-enter",{targetRef:a,close:t.close})},enterCancelled:()=>o.emit("enter-cancelled",a.value),beforeLeave:()=>o.emit("before-leave",a.value),leave:()=>o.emit("leave",a.value),afterLeave:()=>{o.emit("after-leave",a.value),l.value===!1&&(n.value=!1)},leaveCancelled:()=>o.emit("leave-cancelled",a.value)},show:y,teleportTarget:r,transition:v.transition?v.transition/1e3+"s":void 0}}});function T(t,o,r,i,s,d){return t.inserted?(e.openBlock(),e.createBlock(e.Teleport,{key:0,to:t.teleportTarget,disabled:t.disabled},[e.createVNode(e.Transition,e.mergeProps({appear:"",name:t.CLASS_NAME},e.toHandlers(t.onTransitionEmit)),{default:e.withCtx(()=>{var l;return[e.withDirectives(e.createElementVNode("div",e.mergeProps({ref:"modalRef",role:"dialog",tabindex:"-1","aria-modal":"true","aria-label":"Modal window",class:[t.CLASS_NAME,{[`${t.CLASS_NAME}-show`]:t.show},{[`${t.CLASS_NAME}-latest`]:t.latest}],style:{transitionDuration:t.transition}},t.$attrs),[e.createElementVNode("div",{class:e.normalizeClass(`${t.CLASS_NAME}-content`),style:e.normalizeStyle({transitionDuration:t.transition,...(l=t.mergeOptions)==null?void 0:l.styleModalContent}),onMousedown:o[0]||(o[0]=e.withModifiers((...n)=>t.onMouseDownDimmed&&t.onMouseDownDimmed(...n),["self"])),onMouseup:o[1]||(o[1]=e.withModifiers((...n)=>t.onMouseUpDimmed2&&t.onMouseUpDimmed2(...n),["self"])),onTouchend:o[2]||(o[2]=e.withModifiers(n=>t.close(),["self"]))},[e.renderSlot(t.$slots,"default",{emitClose:t.emitClose,class:e.normalizeClass({modal:!0,"modal-sheet":!0})},void 0,!0),e.renderSlot(t.$slots,"close",{},void 0,!0)],38)],16),[[e.vShow,t.show]])]}),_:3},16,["name"])],8,["to","disabled"])):e.createCommentVNode("",!0)}var A=N(k,[["render",T],["__scopeId","data-v-65b97ef8"]]);const f="VueUniversalModal",p="vue-universal-modal";var L={install:(t,o={})=>{const{teleportTarget:r="",modalComponent:i="Modal"}=o;if(!r)return;const s=e.ref(new Set),d=n=>{s.value.add(n)},l=n=>{s.value.delete(n)};t.provide(f,{teleportTarget:r,visibleModals:e.readonly(s),addVisibleModals:d,removeVisibleModals:l}),t.component(i,A)}};c.CLASS_NAME=p,c.PLUGIN_NAME=f,c.default=L,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
